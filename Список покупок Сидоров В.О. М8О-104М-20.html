<!DOCTYPE html>
<html>


  <head>
    <title>Список покупок</title>   
  </head>

  
  <body> 
      <h1>Список покупок</h1>
      
<div class="form">
  <label for="item">Наименование товара: </label><input type="text" id="item">
  <label for="price">Цена товара: </label><input type="number" id="price">
  <label for="price">Кол-во товара: </label><input type="text" id="amount">
  <button id="submit">Добавить товар в список</button>
  <button id="clear">Очистить все</button>
</div>

<ul id="list"> 
</ul>

<p id="total"></p> <!-- Для вывода на экран суммарной цены при любом её изменении -->
  </body>
  
  
  <script>
   var itemInput = document.getElementById("item");
   var itemPrice = document.getElementById("price");
   var itemAmount = document.getElementById("amount");
   var clear = document.getElementById("clear");
   var submit = document.getElementById("submit");
   var list = document.getElementById("list");
   var totalPrice = 0;
   var i = 1; //Для кнопки "Купить" или "В корзине"
    
   document.getElementById("total").innerHTML = "Суммарная цена составляет 0 рублей"; //Чтобы надпись была в самом начале, даже когда никаких товаров еще не добавлено

//НАЖАЛИ НА ДОБАВИТЬ ТОВАР В СПИСОК
   submit.onclick = function() { //По клику кнопки submit выполняем функцию addItem (создаем пункт списка, добавляем в него значение ввода, очищаем строку ввода)
     var currentItem = itemInput.value; //Текущее значение ввода
     var currentPrice = itemPrice.value; //Текущее значение ввода цены
     var currentAmount = itemAmount.value; //Текущее значение ввода кол-ва
     var listItem = document.createElement("li"); //Создаем список
     
     //Проверка поля цены
     currentPrice = parseInt(currentPrice, 10); //Переводим в число выражение, записанное в поле цены
     if (isNaN(currentPrice) || currentPrice < 0) { //Если строка ЦЕНЫ пуста, или там НЕ число, 
     currentPrice = 0;          //делаем цену равной 0
     } 
     
     //Проверка поля цены
     currentPrice = parseInt(currentPrice, 10); //Переводим в число выражение, записанное в поле цены
     if (currentAmount.replace(/\s/g, '') === "") { //Если строка КОЛ_ВА пуста, 
     currentAmount = 1;          //делаем кол-во равному 1
     } 
     
     //Определяем listItem - элемент списка
     listItem.innerHTML = currentItem + " " + "(" + currentPrice + " рублей) " + currentAmount + " единиц(ы)"; //Это свойство предоставляет простой способ полностью заменить содержимое элемента. Придаем listItem значение текущего ввода (currentItem + currentPrice)
     
     //Добаялем listItem в список
     list.appendChild(listItem); //list - это родительский элемент. listItem -  это элемент, который вставляется в конец list. appendChild - вставляет элемент (НЕ удаляет)
     
     //Проверка поля наименования
     if (currentItem.replace(/\s/g, '') === "") { //Если в название товара НИЧЕГО или пробелы
     listItem = ""; //Добавляем в лист пустой элемент (НЕ добавляем ничего, то есть)
     itemInput.value = ""; //Очищаем строку ввода
     itemPrice.value = ""; //Очищаем строку ввода цены
     } else { //Если в названии что-то есть
     var button = document.createElement("button"); //Создаем кнопку
     button.innerHTML = "Добавить в корзину!"; //Надпись на кнопке
     button.setAttribute("id", "btnid" + i);
     list.appendChild(button);

     i = i + 1;
     
     //КНОПКА КУПИТЬ
     var i_end = i;
     
     for (var j = 1; j < i_end; j++) {
       var mybtn = document.getElementById("btnid" + j);
     } //for закрывается   
     
       mybtn.onclick = function() {
         if (mybtn.innerHTML == "Добавить в корзину!") {
         mybtn.innerHTML = "В корзине! (Нажмите, чтобы убрать)";
         } else {
         mybtn.innerHTML = "Добавить в корзину!";
         } //else закрывается
       } //function закрывается

     } //else закрывается
     
     //Суммарная цена
     totalPrice = totalPrice + currentPrice*currentAmount; //Считаем суммарную цену
     
     //Наводим красоту
     itemInput.value = ""; //Очищаем строку ввода
     itemPrice.value = ""; //Очищаем строку ввода цены
     itemAmount.value = ""; //Очищаем строку ввода кол-ва
     
     //Выводим суммарную цену на экран
     document.getElementById("total").innerHTML = "Суммарная цена составляет " + totalPrice + " рублей";
   }
   


   

//НАЖАЛИ НА ОЧИСТИТЬ ВСЕ    
   clear.onclick = function() { //По клику кнопки clear делаем следущее:
     list.innerHTML = ""; //Очищаем весь лист
     itemInput.value = ""; //Очищаем строку ввода
     itemPrice.value = ""; //Очищаем строку ввода цены
     totalPrice = 0; //Обнуляем общую цену
     currentPrice = 0; //Обнуляем текущую цену товара
     document.getElementById("total").innerHTML = "Суммарная цена составляет 0 рублей"; //Очищаем строку с суммарной ценой
     i = 1;
   }
  </script>
  
  
</html>
